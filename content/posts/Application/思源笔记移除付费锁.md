---
title: "思源笔记移除付费锁"
date: "2025-09-12T22:36:19+08:00"
categories: "Application"
tags: ["Application"]
author: "Baofeng Zhang"
showToc: true
TocOpen: false
draft: false
hidemeta: false
comments: false
description: "移除思源笔记的第三方同步功能的付费限制。"
canonicalURL: "https://canonical.url/to/page"
disableHLJS: true # to disable highlightjs
disableShare: false
disableHLJS: false
hideSummary: false
searchHidden: false
ShowReadingTime: true
ShowBreadCrumbs: true
ShowPostNavLinks: true
ShowWordCount: true
ShowRssButtonInSectionTermList: true
UseHugoToc: true
cover:
    image: "<image path/url>"
    alt: "<alt text>" 
    caption: "<text>" # display caption under cover
    relative: false # when using page bundles set this to true
    hidden: true # only hide on current single page
editPost:
    URL: "https://github.com/<path_to_repo>/content"
    Text: "Suggest Changes" # edit text
    appendFilePath: true # to append file path to Edit link
---

思源笔记是一款隐私优先的个人知识管理系统，支持细粒度块级引用和 Markdown 所见即所得。

虽然思源笔记的存储方式非传统markdown文件，但是这也同时便于引入更多的功能特性。除了开通会员使用官方服务器同步外，思源笔记内置S3与WebDAV同步接口，可以自行对接第三方网络存储。该功能并非免费，需要进行一次性付费或者开通会员才能使用。但这是一款开源软件，通过修改源码并重新编译，可以绕过付费限制，直接使用S3与WebDAV同步功能。

## 源代码的下载与编译

### Windows (amd64)

```bash
# Clone Repository
git clone https://github.com/siyuan-note/siyuan.git
cd siyuan

# Building UI
cd app
pnpm install
pnpm run build
cd ..

# Cleaning Builds
rm -rf app\build
rm -rf app\kernel

# Preparing GO
go version
set GO111MODULE=on
set GOPROXY=https://mirrors.aliyun.com/goproxy/
set CGO_ENABLED=1

# Building Kernel amd64
cd kernel
goversioninfo -platform-specific=true -icon=resource/icon.ico -manifest=resource/goversioninfo.exe.manifest
set GOOS=windows
set GOARCH=amd64
go build --tags fts5 -v -o "../app/kernel/SiYuan-Kernel.exe" -ldflags "-s -w -H=windowsgui" .
cd ..

# Building Electron App amd64
cd app
cp "elevator\elevator-amd64.exe" "kernel\elevator.exe"
pnpm run dist
cd ..
```

编译结果：

- `siyuan/app/build/siyuan-xxx-win.exe`为Windows x64平台的安装包
- `siyuan/app/build/win-unpacked`为Windows x64平台的免安装版

### Android (arm64)

```bash
# Clone Repository
git clone https://github.com/siyuan-note/siyuan.git
cd siyuan

# Building UI
cd app
pnpm install
pnpm run build
cd ..

# Cleaning Builds
rm -rf app\build
rm -rf app\kernel

# Preparing GO
go version
set GO111MODULE=on
set GOPROXY=https://mirrors.aliyun.com/goproxy/
set CGO_ENABLED=1

# Building Kernel arm64
cd kernel
set JAVA_TOOL_OPTIONS=-Dfile.encoding=UTF-8
gomobile bind --tags fts5 -ldflags "-s -w"  -v -o kernel.aar -target=android/arm64 -androidapi 26 ./mobile/
cd ..

# Packaging resource files
cd app
zip -r app.zip appearance/ guide/ stage/ changelogs/.
cd ../..

# Clone Repository
git clone https://github.com/siyuan-note/siyuan-android.git
cd siyuan-android

# Building Kernel android
mkdir app/libs/
cp ../siyuan/kernel/kernel.aar app/libs/kernel.aar

mkdir app/src/main/assets/
mv ../siyuan/app/app.zip app/src/main/assets/app.zip

# Generating signing (Skip if you already have)
cd app
keytool -genkeypair -v -keystore siyuan-android.jks -keyalg RSA -keysize 2048 -validity 10000 -alias androiddebugkey -dname "CN=SiYuan, OU=Android, O=SiYuan, L=Beijing, ST=Beijing, C=CN"
android
android
cd ..

# Generating configurations for signing
cp signings.templates.gradle signings.gradle
# Edit signings.gradle when needed

# Building APP
./gradlew clean buildReleaseTask
```

编译结果：

- `siyuan-android\app\build-release\siyuan-xxx-all`

>  注意：Android编译后的APP尚未经过完全测试，可能存在未知问题。

## 移除付费锁

放开前端付费校验，以便无需登录付费也可使用 S3/WebDAV 同步。`siyuan/app/src/util/needSubscribe.ts`

```diff
export const isPaidUser = () => {
-	return window.siyuan.user && (0 === window.siyuan.user.userSiYuanSubscriptionStatus || 1 === window.siyuan.user.userSiYuanOneTimePayStatus);
+	return true;
};
```

【可选】隐藏顶部工具栏上的会员功能图标。`siyuan/app/src/layout/topBar.ts > initBar`

```diff
-<div id="toolbarVIP" class="fn__flex${window.siyuan.config.readonly ? " fn__none" : ""}"></div>
+<div id="toolbarVIP" class="fn__flex fn__none"></div>
```

【可选】隐藏设置窗口中的账户页面。`siyuan/app/src/config/index.ts > openSetting > dialog > content`

```diff
-	<li data-name="account" class="b3-list-item"><svg class="b3-list-item__graphic"><use xlink:href="#iconAccount"></use></svg><span class="b3-list-item__text">${window.siyuan.languages.account}</span></li>
+	<li data-name="account" class="b3-list-item fn__none"><svg class="b3-list-item__graphic"><use xlink:href="#iconAccount"></use></svg><span class="b3-list-item__text">${window.siyuan.languages.account}</span></li>
```

完成以上改动后重新编译。

## 首次编译前可能用到的命令

安装`pnpm`

```bash
npm i -g pnpm@10.15.1
```

设定 Go 代理（国内环境推荐）

```bash
setx GOPROXY https://mirrors.aliyun.com/goproxy/
```

安装 `goversioninfo`

```bash
go install github.com/josephspurrier/goversioninfo/cmd/goversioninfo@latest
```

安装`gomobile`

```bash
set GO111MODULE=on
go install golang.org/x/mobile/cmd/gomobile@latest
gomobile init
gomobile version
```









